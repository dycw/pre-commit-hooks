#!/usr/bin/env bash

path="$(git rev-parse --show-toplevel)/.git/hooks/pre-commit"
if [ -d "$path" ]; then
	printf "ERROR: did not expect a directory at:\n    %s\n" "$path"
	exit 1
elif [ -e "$path" ]; then
	if [[ "$1" == --yes ]]; then
		printf "Installing pre-commit hooks\n"
		install=1
	else
		printf "Pre-commit hook already installed:\n"
		read -n1 -p "Overwrite? (y/n): " -r ans
		printf "\n"
		if [[ "$ans" == "y" ]]; then
			printf "Re-installing pre-commit hooks\n"
			install=0
		else
			install=1
		fi
	fi
else
	printf "Installing pre-commit hooks\n"
	install=0
fi
if [ $install -eq 0 ]; then
	rm "$path"
	source="$(dirname "$(readlink -f "$0")")/pre-commit"
	cp "$source" "$path"
fi
